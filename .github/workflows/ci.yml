name: ci

on: 
  push:
    branches:
      - master
  workflow_dispatch:
    branches:
      - master  

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:

      - uses: actions/checkout@v3

      - run: |
          ls -ali
          chmod +x ./ociresources.bash
          chmod +x ./some-bash-script.bash
          ls -ali
      
      - name: Install OCI CLI
        uses: cpruvost/oci-cli-action@v1.0.3
        with:
          region: "eu-marseille-1"

      - run: cat ~/.oci/config

      - run: |
         oci -v
         oci iam region list

      - name: Run OCI Counter Script
        uses: cpruvost/oci-cpu-mem@master
        id: counter
        with:
          region: "${{ secrets.OCI_REGION }}"

      - run: |
          echo "${{ steps.counter.outputs.some_output }}"   
        